# Expand

## 目次
- [variable.c](#variablec)
- [quote_removal.c](#quote_removalc)
- [special_param.c](#special_paramc)

## variable.c
1. expand_variable
	- ノードの引数（args）内の変数を展開
	- ノードのファイル名（filename）内の変数を展開
	- 再帰的にノードのリダイレクト、コマンド、および次のノードも処理

2. expand_var_token
	この関数はトークン内の変数を展開します：
	- トークンが有効（NULL以外）で、種類がTK_WORDであるか確認
	- 新しい文字列のためのメモリを確保
	- トークンの文字列を1文字ずつ処理：
		- 引用符を見つけたらadd_quote関数を呼び出す
		- 変数を見つけたらexpand_var_str関数を呼び出す
		- 特殊パラメータを見つけたらexpand_special_param_str関数を呼び出す
		- それ以外の文字はそのまま新しい文字列に追加
	- 元のトークンの文字列を解放し、新しく展開された文字列に置き換え
	- 再帰的に次のトークンも処理

3. add_quote
	- 引用符のタイプ（シングルかダブルか）を判別
	- ダブルクォートの場合は内部の変数展開を許可するフラグを立てる
	- 閉じる引用符が見つかるまで文字を読み取る
		- ダブルクォート内で変数（$変数名）または特殊パラメータを見つけた場合、それを展開
		- それ以外の文字はそのまま追加
	- 閉じる引用符を見つけたら、それも含めて出力先に追加
	- 処理後のポインタ位置を更新

4. expand_var_str
	この関数は変数名を抽出し、その値を展開します
	- 変数名を格納するためのメモリを確保
	- 「$」の次の文字から変数名を読み取る
	- 変数名の最初の文字がアルファベットまたはアンダースコアであることを確認
	- 変数名の残りの文字（アルファベット、数字、アンダースコア）を読み取る
	- xgetenv関数で変数の値を取得
	- 取得した値を出力先（dst）に追加
	- 処理後のポインタ位置をrestに設定

## quote_removal.c

## special_param.c
